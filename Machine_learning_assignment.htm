<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
h1
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";
	color:#345A8A;}
h2
	{margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h3
	{margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h4
	{margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;}
h5
	{margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	color:#4F81BD;
	font-weight:normal;
	font-style:italic;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri","sans-serif";
	color:#345A8A;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:15.0pt;
	font-family:"Calibri","sans-serif";
	color:#345A8A;
	font-weight:bold;}
p.MsoDate, li.MsoDate, div.MsoDate
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoBibliography, li.MsoBibliography, div.MsoBibliography
	{margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.Compact, li.Compact, div.Compact
	{mso-style-name:Compact;
	margin-top:1.8pt;
	margin-right:0in;
	margin-bottom:1.8pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.Author, li.Author, div.Author
	{mso-style-name:Author;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.Abstract, li.Abstract, div.Abstract
	{mso-style-name:Abstract;
	margin-top:15.0pt;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Cambria","serif";}
p.BlockQuote, li.BlockQuote, div.BlockQuote
	{mso-style-name:"Block Quote";
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.Definition, li.Definition, div.Definition
	{mso-style-name:Definition;
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
p.ImageCaption, li.ImageCaption, div.ImageCaption
	{mso-style-name:"Image Caption";
	mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Image Caption";}
span.VerbatimChar
	{mso-style-name:"Verbatim Char";
	mso-style-link:"Source Code";
	font-family:Consolas;}
span.FootnoteRef
	{mso-style-name:"Footnote Ref";
	vertical-align:super;}
span.Link
	{mso-style-name:Link;
	color:#4F81BD;}
p.SourceCode, li.SourceCode, div.SourceCode
	{mso-style-name:"Source Code";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	word-break:break-all;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
span.KeywordTok
	{mso-style-name:KeywordTok;
	font-family:Consolas;
	color:#007020;
	font-weight:bold;}
span.DataTypeTok
	{mso-style-name:DataTypeTok;
	font-family:Consolas;
	color:#902000;}
span.DecValTok
	{mso-style-name:DecValTok;
	font-family:Consolas;
	color:#40A070;}
span.BaseNTok
	{mso-style-name:BaseNTok;
	font-family:Consolas;
	color:#40A070;}
span.FloatTok
	{mso-style-name:FloatTok;
	font-family:Consolas;
	color:#40A070;}
span.CharTok
	{mso-style-name:CharTok;
	font-family:Consolas;
	color:#4070A0;}
span.StringTok
	{mso-style-name:StringTok;
	font-family:Consolas;
	color:#4070A0;}
span.CommentTok
	{mso-style-name:CommentTok;
	font-family:Consolas;
	color:#60A0B0;
	font-style:italic;}
span.OtherTok
	{mso-style-name:OtherTok;
	font-family:Consolas;
	color:#007020;}
span.AlertTok
	{mso-style-name:AlertTok;
	font-family:Consolas;
	color:red;
	font-weight:bold;}
span.FunctionTok
	{mso-style-name:FunctionTok;
	font-family:Consolas;
	color:#06287E;}
span.RegionMarkerTok
	{mso-style-name:RegionMarkerTok;
	font-family:Consolas;}
span.ErrorTok
	{mso-style-name:ErrorTok;
	font-family:Consolas;
	color:red;
	font-weight:bold;}
span.NormalTok
	{mso-style-name:NormalTok;
	font-family:Consolas;}
p.SourceCode0, li.SourceCode0, div.SourceCode0
	{mso-style-name:"Source Code";
	mso-style-link:"Verbatim Char";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	background:#F8F8F8;
	word-break:break-all;
	font-size:12.0pt;
	font-family:"Cambria","serif";}
span.KeywordTok0
	{mso-style-name:KeywordTok;
	font-family:Consolas;
	color:#204A87;
	background:#F8F8F8;
	font-weight:bold;}
span.DataTypeTok0
	{mso-style-name:DataTypeTok;
	font-family:Consolas;
	color:#204A87;
	background:#F8F8F8;}
span.DecValTok0
	{mso-style-name:DecValTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.BaseNTok0
	{mso-style-name:BaseNTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.FloatTok0
	{mso-style-name:FloatTok;
	font-family:Consolas;
	color:#0000CF;
	background:#F8F8F8;}
span.CharTok0
	{mso-style-name:CharTok;
	font-family:Consolas;
	color:#4E9A06;
	background:#F8F8F8;}
span.StringTok0
	{mso-style-name:StringTok;
	font-family:Consolas;
	color:#4E9A06;
	background:#F8F8F8;}
span.CommentTok0
	{mso-style-name:CommentTok;
	font-family:Consolas;
	color:#8F5902;
	background:#F8F8F8;
	font-style:italic;}
span.OtherTok0
	{mso-style-name:OtherTok;
	font-family:Consolas;
	color:#8F5902;
	background:#F8F8F8;}
span.AlertTok0
	{mso-style-name:AlertTok;
	font-family:Consolas;
	color:#EF2929;
	background:#F8F8F8;}
span.FunctionTok0
	{mso-style-name:FunctionTok;
	font-family:Consolas;
	color:black;
	background:#F8F8F8;}
span.RegionMarkerTok0
	{mso-style-name:RegionMarkerTok;
	font-family:Consolas;
	background:#F8F8F8;}
span.ErrorTok0
	{mso-style-name:ErrorTok;
	font-family:Consolas;
	background:#F8F8F8;
	font-weight:bold;}
span.NormalTok0
	{mso-style-name:NormalTok;
	font-family:Consolas;
	background:#F8F8F8;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{font-size:12.0pt;
	font-family:"Cambria","serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US>

<div class=WordSection1>

<h1><a name=an-alogrithm-to-identify-how-well-you-ex></a>An alogrithm to
identify how well you exercize</h1>

<h2><a name=executive-summary></a>Executive summary:</h2>

<p class=MsoNormal>As part of the Coursera Machine Learning course this report
aims to identify the fedilety of how people exercize by using the data recorded
from accelerometers on the belt, forearm, arm, and dumbell of an indivudal.</p>

<h3><a name=analysis-data></a>Analysis data</h3>

<p class=MsoNormal>The data for this assignment was generated by 6 indivudals
instructed to carry out the same exercize (dumbell curls) with diffrent levels
of fedilitey to the ideal case as recorded in the classe variable;
&quot;A&quot; being the best way to carry out the exercixe and &quot;E&quot;
the worst. The corresponding acellerometer data during the test was recorded
and stored in a number of additional potential predictor variables, more
information can be found here <a href="http://groupware.les.inf.puc-rio.br/har"><span
class=Link><span style='text-decoration:none'>Data set details</span></span></a><span
class=Link>.</span></p>

<p class=MsoNormal>The data is used to develop a machine learning alogrithm
using techniques learned in the course that is capable of distingushing the
classe of an exercize given the same predictors variables as defined in the
training data set.The model is then used to to predict 20 different test cases.
the training data can be found here (<a
href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"><span
class=Link><span style='text-decoration:none'>https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv</span></span></a>)
and the test data here (<a
href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"><span
class=Link><span style='text-decoration:none'>https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv</span></span></a>)</p>

<h3><a name=read-data-set></a>read data set</h3>

<p class=SourceCode0><span class=NormalTok0><span style='font-size:11.0pt'>rawtrainingset
&lt;-</span></span><span class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>read.csv</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=StringTok0><span style='font-size:11.0pt'>'pml-training.csv'</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>rawtestingset &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>read.csv</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=StringTok0><span style='font-size:11.0pt'>'pml-testing.csv'</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span></p>

<h3><a name=preprocessing></a>Preprocessing</h3>

<p class=MsoNormal>Upon examination there are 159 variables in the dataset (see
below). However many of these columns lack significant data or contain
factordata that is notrelated to the sensor data. In particular columns 1:7 (<span
style='background:aqua'>highlight</span>) contain factor data.</p>

<p class=SourceCode0><span class=NormalTok0><span style='font-size:10.0pt'>trainingdata
&lt;-</span></span><span class=StringTok0><span style='font-size:10.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:10.0pt'>preprocesssdat</span></span><span
class=NormalTok0><span style='font-size:10.0pt'>(rawtrainingset)</span></span></p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>##  
[1] <span style='background:aqua'>&quot;X&quot;</span>                        <span
style='background:aqua'>&quot;user_name&quot;</span>               </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##   [3] <span
style='background:aqua'>&quot;raw_timestamp_part_1&quot;</span>     <span
style='background:aqua'>&quot;raw_timestamp_part_2&quot;</span>    </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##   [5] <span
style='background:aqua'>&quot;cvtd_timestamp&quot;</span>           <span
style='background:aqua'>&quot;new_window&quot;</span>              </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##   [7] <span
style='background:aqua'>&quot;num_window&quot;</span>              
&quot;roll_belt&quot;               </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##   [9]
&quot;pitch_belt&quot;  </span></span></p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>##...............Numeric
accelerometer data columns.........</span></span></p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>##
[159] &quot;magnet_forearm_z&quot;         &quot;classe&quot;                  </span></span></p>

<p class=MsoNormal>It is decided to exclude this for this first analyses whist
it may effect the quality of the data, for example the &quot;user&quot; factor
identifying the participant who carries out the exercize, one would expect each
user to have a unique way of exercizing and this can contaminate signals from
the acellerometers However it is reasonable to assumed this is a secondary
effect since all the exercizes werecarried outunderthe supervision os a weight
training expert.</p>

<p class=MsoNormal>The preprocessing of the data was carried out using the <b>preprocessing()</b>
script For brevity it is not diaplayed here but can be in this directory. To
summarise the source function it removes the 1st 7 columns (non acellerometer
data) and loops through all the other acellerometer columns to see if they
contains more that 70% numeric content if the column has less numeric content
than this it is discarded.</p>

<p class=SourceCode0><span class=CommentTok0><span style='font-size:11.0pt'>#Load
script to preprocess raw data</span></span><br>
<span class=KeywordTok0><span style='font-size:11.0pt'>source</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;preprocessdat.R&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'>#process training set</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>names&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>c</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>colnames</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(trainingdata))</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>names&lt;-names[-</span></span><span
class=DecValTok0><span style='font-size:11.0pt'>1</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>]</span></span><span
class=CommentTok0><span style='font-size:11.0pt'># remove classe from list</span></span></p>

<p class=SourceCode0><span class=CommentTok0><span style='font-size:11.0pt'>#set
testing set to have the same columns</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>testing &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=NormalTok0><span style='font-size:11.0pt'>rawtestingset[ ,names]</span></span></p>

<p class=MsoNormal>The preprocessing produces a reduced data set having only 52
columns that have the best chance of being meaningful predictors for the classe
factor.</p>

<h3><a name=data-partition></a>Data partition</h3>

<p class=MsoNormal>The data was partitioned as follows the raw training set was
split in two a training(75%) and validation(25%) subset<br>
<span class=CommentTok0># create training and validation subset in original
training set </span><span style='font-size:14.0pt'><br>
</span><span class=NormalTok0>trainset &lt;-</span><span class=StringTok0> </span><span
class=KeywordTok0>createDataPartition</span><span class=NormalTok0>(</span><span
class=DataTypeTok0>y=</span><span class=NormalTok0>trainingdata$classe,</span><span
class=DataTypeTok0>p=</span><span class=FloatTok0>0.75</span><span
class=NormalTok0>, </span><span class=DataTypeTok0>list=</span><span
class=OtherTok0>FALSE</span><span class=NormalTok0>)</span><span
style='font-size:14.0pt'><br>
</span><span class=NormalTok0>training &lt;-</span><span class=StringTok0> </span><span
class=NormalTok0>trainingdata[trainset,]</span><span style='font-size:14.0pt'><br>
</span><span class=NormalTok0>validate &lt;-</span><span class=StringTok0> </span><span
class=NormalTok0>trainingdata[-trainset,]</span></p>

<p class=MsoNormal><b><span style='font-size:14.0pt;font-family:"Calibri","sans-serif";
color:#4F81BD'>Principal component analysis</span></b></p>

<p class=MsoNormal>A principal component analysis using Caret()shows that 80%
of the observedvariation can be captured in 12 components.</p>

<p class=MsoNormal><span style='font-size:11.0pt'><br>
</span><span class=CommentTok0><span style='font-size:11.0pt'>#Principal
component analysis</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>preProc &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>preProcess</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(training,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;pca&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>thresh=</span></span><span
class=FloatTok0><span style='font-size:11.0pt'>0.8</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>train.PCs &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(preProc,training)</span></span></p>

<p class=MsoNormal><b><span style='font-size:14.0pt;font-family:"Calibri","sans-serif";
color:#4F81BD'>Simple GLM model</span></b></p>

<p class=MsoNormal>As a 1st cut the PCA analysis was used to build a simple GLM
regression model. Here a model is run on classe with principle components using
<b>as.numeric()</b> to convert the classe factors to numbers, ie A:F becomes
1:5 .Beacuse the predicted outcomes is a real number the result is rounded to
generate the final class prediction</p>

<p class=SourceCode0><span class=NormalTok0><span style='font-size:11.0pt'>preProc
&lt;-</span></span><span class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>preProcess</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(training,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;pca&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>thresh=</span></span><span
class=FloatTok0><span style='font-size:11.0pt'>0.8</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>train.PCs &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(preProc,training)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'># GLM model
outcome=classe and principle components use as.numeric to convert </span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>modelFit1&lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>train</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>as.numeric</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(training$classe) ~.,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;glm&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>data=</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>train.PCs)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'># calculate principal
component for validation data</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>validate.princ.comps
&lt;-</span></span><span class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(preProc,validate[,-</span></span><span
class=DecValTok0><span style='font-size:11.0pt'>1</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>])</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'># used test data motel
to predict validation data</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>validatepredictions&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(modelFit1,validate.princ.comps)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'>#..........note
&quot;validatepredictions&quot; predictions are not integers </span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>validatepredictions&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>round</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(modelFit1,validate.princ.comps))</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'># compare results with
confusion to get the accuracy</span></span><br>
<span class=KeywordTok0><span style='font-size:11.0pt'>confusionMatrix</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>as.numeric</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(validate$classe),validatepredictions)</span></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>## <b><u>Confusion
Matrix and Statistics</u></b></span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          
Reference</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prediction  
1   2   3   4   5</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          1 200
617 531  47   0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          2   3
227 635  84   0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          3   0
273 570  12   0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          4  
0  84 503 215   2</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          5   8
122 510 254   7</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Overall
Statistics                                           </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##               
<span style='background:yellow'>Accuracy : 0.2486</span>          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                 
95% CI : (0.2365, 0.2609)</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     No
Information Rate : 0.5606          </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     P-Value
[Acc &gt; NIR] : 1               </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Statistics by
Class:</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                     
Class: 1 Class: 2 Class: 3 Class: 4 Class: 5</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Sensitivity           0.94787  0.17158   0.2073  0.35131 0.777778</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Specificity           0.74537  0.79838   0.8677  0.86277 0.817365</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Pos Pred
Value        0.14337  0.23920   0.6667  0.26741 0.007769</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Neg Pred
Value        0.99687  0.72288   0.4618  0.90317 0.999500</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Prevalence            0.04303  0.26978   0.5606  0.12480 0.001835</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Rate        0.04078  0.04629   0.1162  0.04384 0.001427</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Prevalence  0.28446  0.19352   0.1743  0.16395 0.183728</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Balanced
Accuracy     0.84662  0.48498   0.5375  0.60704 0.797571</span></span></p>

<p class=MsoNormal>The model has only ~<span style='background:yellow'>25%</span>
accuracy each classe is ~1/5 of the data so we have a 20% chance of guessing
right ie. this model is little better than chance.Its not clear why the PCA
naalysis shows that 80 % o fthe varianceis captured by the 12 PC components but
the model performs so badly, It is suspected to be the concersion of the class
factor into a numeric variable.</p>

<h3>Different ML algorithm models</h3>

<p class=MsoNormal>Next a series of general ML alogrithms are tried to see
which would perform best on the data A Recursive partitioning tree model A
gradient boosting machine model with 50 trees A gradient boosting machine model
with 100 trees A random forest model with 50 trees. Model code summarized below</p>

<p class=SourceCode0><span class=CommentTok0><span style='font-size:11.0pt'>#Recursive
partitioning tree model</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>modelFit2&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>train</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(classe ~.,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method =</span></span><span
class=NormalTok0><span style='font-size:11.0pt'> </span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;rpart&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>data =</span></span><span
class=NormalTok0><span style='font-size:11.0pt'> training)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'>#gradient boosting
machine model</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>modelFit3 &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>train</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(classe ~.,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;gbm&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>data=</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>training,</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>                  </span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>verbose=</span></span><span
class=OtherTok0><span style='font-size:11.0pt'>FALSE</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>tuneGrid =</span></span><span
class=NormalTok0><span style='font-size:11.0pt'> gbmcontrol)</span></span><br>
<span class=CommentTok0><span style='font-size:11.0pt'>#Random forest model</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>modelFit4 &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>train</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(classe ~.,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>method=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;rf&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>                  </span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>data=</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>training,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>prox=</span></span><span
class=OtherTok0><span style='font-size:11.0pt'>TRUE</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>ntree =</span></span><span
class=NormalTok0><span style='font-size:11.0pt'> </span></span><span
class=DecValTok0><span style='font-size:11.0pt'>2</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)</span></span></p>

<h3><a name=the-recursive-partitioning-tree-model></a>The Recursive
partitioning tree model</h3>

<p class=MsoNormal>A schematic tree of this model is shown in the following
plot. The results from the model are also plotted.It can be seen this model has
~<b><span style='background:yellow'>50%</span> accuracy</b>.The confusion
matrix is plotted for the training data and the validation data.</p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>## <b><u>Confusion
Matrix and Statistics</u></b></span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          
Reference</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prediction   
A    B    C    D    E</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          A
1271   19  104    0    1</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          B 
407  316  226    0    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          C 
414   25  416    0    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          D 
374  139  291    0    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          E 
138  114  217    0  432 </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Overall
Statistics                                          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##               
<span style='background:yellow'>Accuracy : 0.4965</span>          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                 
95% CI : (0.4824, 0.5106)</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     No
Information Rate : 0.531           </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     P-Value
[Acc &gt; NIR] : 1               </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Statistics by
Class:</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                     
Class: A Class: B Class: C Class: D Class: E</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Sensitivity            0.4881  0.51550  0.33174       NA  0.99769</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Specificity            0.9461  0.85248  0.87973   0.8361  0.89510</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Pos Pred
Value         0.9111  0.33298  0.48655       NA  0.47947</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Neg Pred
Value         0.6201  0.92491  0.79304       NA  0.99975</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Prevalence             0.5310  0.12500  0.25571   0.0000  0.08830</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Rate         0.2592  0.06444  0.08483   0.0000  0.08809</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Prevalence   0.2845  0.19352  0.17435   0.1639  0.18373</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Balanced
Accuracy      0.7171  0.68399  0.60573       NA  0.94640</span></span></p>

<p class=MsoNormal>Clearly a partition style tree model is much better with an
accuracy <b>~50%</b> The algorithm seems to struggle to identify classe “D” .To
improve the predictions the next step is to look at aggregated type models
.boosted tree models and random forests.</p>

<h4><a name=the-gradient-boosting-machine-model-with></a>The gradient boosting
machine model with 50 trees</h4>

<p class=MsoNormal>Here a gradient boosted model is run on the same data. The
results are shown below .his model has an impressive <b><span style='background:
yellow'>93%</span></b> accuracy.The confusion matrix is plotted for the
training data and the validation data.</p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>## <b><u>Confusion
Matrix and Statistics</u></b></span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          
Reference</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prediction   
A    B    C    D    E</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          A
1351   26    8    8    2</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          B  
81  814   39   11    4</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          C   
0   41  799   13    2</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          D   
4    9   45  738    8</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          E   
4   24   20   18  835</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Overall
Statistics                                         </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##               
<span style='background:yellow'>Accuracy : 0.9252</span>          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                 
95% CI : (0.9174, 0.9324)</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     No
Information Rate : 0.2936          </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     P-Value
[Acc &gt; NIR] : &lt; 2.2e-16       </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Statistics by
Class:</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                     
Class: A Class: B Class: C Class: D Class: E</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Sensitivity           
0.9382   0.8906   0.8771   0.9365   0.9812</span></span><span style='font-size:
10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Specificity            0.9873   0.9662   0.9860   0.9840   0.9837</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Pos Pred
Value         0.9685   0.8577   0.9345   0.9179   0.9267</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Neg Pred
Value         0.9746   0.9747   0.9723   0.9878   0.9960</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Prevalence             0.2936   0.1864   0.1858   0.1607   0.1735</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Rate         0.2755   0.1660   0.1629   0.1505   0.1703</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Prevalence   0.2845   0.1935   0.1743   0.1639   0.1837</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Balanced
Accuracy      0.9627   0.9284   0.9315   0.9603   0.9825</span></span></p>

<p class=MsoNormal>The model is rerun with n.trees=100 trees. An the results
shown below now the prediction accuracy has increaced to <b><span
style='background:yellow'>96%</span> accuracy</b>.The confusion matrix is
plotted for the training data and the validation data.</p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>## <b><u>Confusion
Matrix and Statistics</u></b></span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          
Reference</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prediction   
A    B    C    D    E</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          A
1381   10    1    1    2</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          B  
39  882   22    3    3</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          C   
0   26  819    9    1</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          D   
0    4   27  760   13</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          E    0   
9    8   16  868</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Overall
Statistics                                          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##               
<span style='background:yellow'>Accuracy : 0.9604</span>          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                 
95% CI : (0.9546, 0.9657)</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     No
Information Rate : 0.2896          </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     P-Value
[Acc &gt; NIR] : &lt; 2.2e-16       </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Statistics by
Class:</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                     
Class: A Class: B Class: C Class: D Class: E</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Sensitivity            0.9725   0.9474   0.9339   0.9632   0.9786</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Specificity            0.9960   0.9831   0.9911   0.9893   0.9918</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Pos Pred
Value         0.9900   0.9294   0.9579   0.9453   0.9634</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Neg Pred
Value         0.9889   0.9876   0.9857   0.9929   0.9953</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Prevalence             0.2896   0.1898   0.1788   0.1609   0.1809</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Rate         0.2816   0.1799   0.1670   0.1550   0.1770</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Prevalence   0.2845   0.1935   0.1743   0.1639   0.1837</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Balanced
Accuracy      0.9843   0.9653   0.9625   0.9763   0.9852</span></span></p>

<h4><a name=random-forest-model></a>Random Forest model</h4>

<p class=MsoNormal>The last model looked at was a random forest model. the
results are shown below this model gas has~ <b><span style='background:yellow'>99%</span>
accuracy</b>. The confusion matrix is plotted for the training data and the
validation data.</p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:9.0pt'>##<b>
<u>Confusion Matrix and Statistics</u></b></span></span><span style='font-size:
10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          
Reference</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prediction   
A    B    C    D    E</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          A
1391    4    0    0    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          B   
7  937    4    1    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          C   
0    2  853    0    0</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          D   
1    0    5  797    1</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##          E   
0    0    2    3  896</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Overall
Statistics                                          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##               
<span style='background:yellow'>Accuracy : 0.9939</span>          </span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                 
95% CI : (0.9913, 0.9959)</span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     No
Information Rate : 0.2853          </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##     P-Value
[Acc &gt; NIR] : &lt; 2.2e-16       </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Statistics by
Class: </span></span><span style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##                     
Class: A Class: B Class: C Class: D Class: E</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Sensitivity            0.9943   0.9936   0.9873   0.9950   0.9989</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>##
Specificity            0.9989   0.9970   0.9995   0.9983   0.9988</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Pos Pred
Value         0.9971   0.9874   0.9977   0.9913   0.9945</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Neg Pred
Value         0.9977   0.9985   0.9973   0.9990   0.9998</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Prevalence            
0.2853   0.1923   0.1762   0.1633   0.1829</span></span><span style='font-size:
10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Rate         0.2836   0.1911   0.1739   0.1625   0.1827</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Detection
Prevalence   0.2845   0.1935   0.1743   0.1639   0.1837</span></span><span
style='font-size:10.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:9.0pt'>## Balanced
Accuracy      0.9966   0.9953   0.9934   0.9967   0.9988</span></span></p>

<p class=MsoNormal>To conclude the best model is the Random forest model here
that model is used to predict the testing data set.</p>

<p class=SourceCode0><span class=CommentTok0><span style='font-size:11.0pt'>#Using
model 4....random forest n=50 trees</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>testingpredictions &lt;-</span></span><span
class=StringTok0><span style='font-size:11.0pt'> </span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>predict</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(modelFit4,</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>newdata=</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>testing)</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>results&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>c</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(</span></span><span
class=DecValTok0><span style='font-size:11.0pt'>1</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>:</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>length</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(testingpredictions))</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>  for (i in </span></span><span
class=DecValTok0><span style='font-size:11.0pt'>1</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>:</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>length</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(testingpredictions)){</span></span><span
class=CommentTok0><span style='font-size:11.0pt'>#loop through all columns </span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>    results[i]&lt;-</span></span><span
class=KeywordTok0><span style='font-size:11.0pt'>paste</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>(i,</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;=&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>,testingpredictions[i],</span></span><span
class=DataTypeTok0><span style='font-size:11.0pt'>sep=</span></span><span
class=StringTok0><span style='font-size:11.0pt'>&quot;&quot;</span></span><span
class=NormalTok0><span style='font-size:11.0pt'>)  }</span></span><br>
<span class=NormalTok0><span style='font-size:11.0pt'>results</span></span></p>

<p class=SourceCode0><span class=VerbatimChar><span style='font-size:10.0pt'>## 
[1] &quot;1=B&quot;  &quot;2=A&quot;  &quot;3=B&quot;  &quot;4=A&quot; 
&quot;5=A&quot;  &quot;6=E&quot;  &quot;7=D&quot;  &quot;8=B&quot; 
&quot;9=A&quot;  &quot;10=A&quot;</span></span><span style='font-size:11.0pt'><br>
</span><span class=VerbatimChar><span style='font-size:10.0pt'>## [11]
&quot;11=B&quot; &quot;12=C&quot; &quot;13=B&quot; &quot;14=A&quot;
&quot;15=E&quot; &quot;16=E&quot; &quot;17=A&quot; &quot;18=B&quot;
&quot;19=B&quot; &quot;20=B&quot;</span></span></p>

</div>

</body>

</html>
